<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YoursMed King - Complete App</title>
    <!-- Icons & Fonts -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@24,400,1,0" />
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&family=Roboto:wght@400;500&display=swap" rel="stylesheet">
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Link to external CSS file -->
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <!-- NAVBAR -->
    <nav>
        <div class="nav-left">
            <button class="icon-btn" onclick="toggleSidebar()"><span class="material-symbols-rounded">menu</span></button>
            <div class="logo" onclick="goHome()">
                <span class="material-symbols-rounded">play_circle</span>
                <span>YoursMed</span>
            </div>
        </div>

        <div class="nav-middle" id="nav-search-bar">
            <!-- Back button only visible on mobile when search is active -->
            <button class="icon-btn" onclick="toggleMobileSearch()" style="margin-right:10px; display:none;" id="back-search"><span class="material-symbols-rounded">arrow_back</span></button>
            <div class="search-container">
                <input type="text" id="search-input" placeholder="Search" onkeyup="handleSearch()">
                <div class="search-btn"><span class="material-symbols-rounded">search</span></div>
            </div>
        </div>

        <div class="nav-right">
            <!-- Search trigger only visible on mobile -->
            <button class="icon-btn mobile-search-trigger" onclick="toggleMobileSearch()"><span class="material-symbols-rounded">search</span></button>
            <button class="icon-btn" onclick="handleUploadClick()"><span class="material-symbols-rounded" style="color: var(--accent-red);">video_call</span></button>
            
            <div style="position: relative;">
                <button class="icon-btn" onclick="toggleNotif()"><span class="material-symbols-rounded" style="color: var(--accent-yellow);">notifications</span></button>
                <div class="notif-badge" id="notif-badge"></div>
                <div class="notif-dropdown" id="notif-dropdown">
                    <h4 style="padding:16px; font-size:15px; font-weight:600; border-bottom:1px solid var(--border);">Recent Uploads</h4>
                    <div id="notif-list"></div>
                </div>
            </div>

            <div id="auth-section">
                <!-- Injected via JS -->
            </div>
        </div>
    </nav>

    <!-- SIDEBAR -->
    <div class="sidebar" id="sidebar">
        <div class="menu-item active" onclick="goHome()" id="btn-home">
            <span class="material-symbols-rounded icon-home">home</span> <span>Home</span>
        </div>
        <div class="menu-item" onclick="openStudio()" id="btn-studio">
            <span class="material-symbols-rounded icon-studio">bar_chart</span> <span>Studio</span>
        </div>
        <div class="menu-item" onclick="openHistory()" id="btn-history">
            <span class="material-symbols-rounded icon-history">history</span> <span>History</span>
        </div>
        <div class="menu-item" onclick="openLikedVideos()" id="btn-liked">
            <span class="material-symbols-rounded icon-liked">thumb_up</span> <span>Liked Videos</span>
        </div>
        
        <hr style="border:0; border-top:1px solid var(--border); margin:12px 0;">
        <h3 class="sub-header">Subscriptions</h3>
        <div id="sub-list-container">
            <div style="padding: 0 12px; font-size: 13px; color: var(--text-light);">Sign in to see subscriptions</div>
        </div>
        
        <div id="logout-btn" style="display:none; margin-top:20px;">
             <div class="menu-item" onclick="handleLogout()">
                <span class="material-symbols-rounded icon-logout">logout</span> <span>Sign Out</span>
            </div>
        </div>
    </div>

    <!-- MAIN GRID -->
    <div class="main-container" id="main-content">
        <!-- Colorful Bubble Categories -->
        <div class="category-bar" id="category-bar">
            <!-- Populated by JS -->
        </div>

        <h2 id="page-heading" class="page-title">Home</h2>
        <div class="grid" id="video-grid">
             <div style="padding:20px; grid-column: 1/-1; text-align:center; color:gray;">Loading Videos...</div>
        </div>
    </div>

    <!-- WATCH OVERLAY -->
    <div class="overlay-screen" id="watch-view">
        <div class="watch-content">
            <button onclick="closeWatch()" style="margin-bottom:15px; font-weight:600; display:flex; align-items:center; gap:5px; color:var(--text-light);"><span class="material-symbols-rounded">arrow_back</span> Back to Home</button>
            <div class="player-wrapper">
                <iframe id="main-player" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
            </div>
            
            <div class="vid-info">
                <h1 id="w-title">Video Title</h1>
                <div class="actions-bar">
                    <div class="chn-actions">
                        <img id="w-chn-img" src="" class="chn-avatar">
                        <div>
                            <h4 id="w-chn-name" style="font-size:16px;">Channel</h4>
                            <span id="w-sub-count" style="font-size:13px; color:var(--text-light);">0 subscribers</span>
                        </div>
                        <button class="sub-btn" id="sub-btn" onclick="toggleSubscribe()">Subscribe</button>
                    </div>
                    <div style="display:flex; gap:10px;">
                        <button class="btn-pill btn-like" id="like-btn" onclick="toggleLike()">
                            <span class="material-symbols-rounded" id="like-icon">thumb_up</span>
                            <span id="w-likes">0</span>
                        </button>
                        <button class="btn-pill btn-dislike" onclick="alert('Dislike registered')">
                            <span class="material-symbols-rounded">thumb_down</span>
                        </button>
                        <button class="btn-pill btn-share" onclick="alert('Shared!')">
                            <span class="material-symbols-rounded">share</span> Share
                        </button>
                    </div>
                </div>
                <div class="desc-box">
                    <p id="w-meta" style="font-weight:700; margin-bottom:8px; color:var(--black);">0 views â€¢ Today</p>
                    <p id="w-desc" style="color:var(--text-light);">Description...</p>
                </div>
            </div>

            <!-- COMMENTS SECTION -->
            <div class="comments-section">
                <h3 style="margin-bottom: 20px;" id="comment-count">Comments</h3>
                <div class="comment-input-area">
                    <img id="my-avatar-comment" src="https://via.placeholder.com/40" class="chn-avatar">
                    <div style="flex:1;">
                        <input type="text" id="comment-text" placeholder="Add a comment...">
                        <div style="display:flex; justify-content:flex-end; margin-top:10px;">
                            <button class="btn-primary" style="width:auto; padding:8px 24px; border-radius:20px;" onclick="postComment()">Comment</button>
                        </div>
                    </div>
                </div>
                <div id="comment-list">
                    <!-- Dynamic Comments -->
                </div>
            </div>
        </div>
    </div>

    <!-- STUDIO OVERLAY -->
    <div class="overlay-screen" id="studio-view" style="background:var(--bg-studio);">
        <div class="studio-layout">
            <div class="studio-nav">
                <div class="menu-item active" onclick="switchStudioTab('dashboard')" id="std-dash-btn">
                    <span class="material-symbols-rounded">dashboard</span> <span>Dashboard</span>
                </div>
                <div class="menu-item" onclick="switchStudioTab('settings')" id="std-set-btn">
                    <span class="material-symbols-rounded">settings</span> <span>Settings</span>
                </div>
                <div class="menu-item" onclick="closeStudio()">
                    <span class="material-symbols-rounded">arrow_back</span> <span>Exit Studio</span>
                </div>
            </div>
            <div class="studio-main" id="studio-content-area"></div>
        </div>
    </div>

    <!-- ANALYTICS MODAL -->
    <div class="modal-wrap" id="analytics-modal">
        <div class="modal-box" style="max-width:800px;">
            <div style="display:flex; justify-content:space-between; margin-bottom:20px;">
                <h2 id="modal-heading">Video Analytics</h2>
                <button class="icon-btn" onclick="closeModals()"><span class="material-symbols-rounded">close</span></button>
            </div>
            <h4 id="an-title" style="color:var(--text-light); margin-bottom:24px;">Video Title</h4>
            
            <div class="chart-wrapper green-bar-chart">
                <h5 style="margin-bottom:15px; color:#444;">Realtime (Last 24 Hours)</h5>
                <canvas id="realtimeChart"></canvas>
            </div>

            <div class="chart-wrapper">
                <h5 style="margin-bottom:15px; color:#444;">Performance (Total Views)</h5>
                <canvas id="perfChart"></canvas>
            </div>
        </div>
    </div>

    <!-- UPLOAD/EDIT MODAL -->
    <div class="modal-wrap" id="generic-modal">
        <div class="modal-box">
            <div style="display:flex; justify-content:space-between; margin-bottom:24px;">
                <h2 id="modal-title" style="color:var(--primary-dark);">Upload Video</h2>
                <button class="icon-btn" onclick="closeModals()"><span class="material-symbols-rounded">close</span></button>
            </div>
            <input type="hidden" id="inp-id">
            <div class="inp-group">
                <label>Title</label>
                <input type="text" id="inp-title" placeholder="Video Title">
            </div>
            <div class="inp-group">
                <label>Thumbnail URL</label>
                <input type="text" id="inp-thumb" placeholder="https://...">
            </div>
            <div class="inp-group">
                <label>Video URL (YouTube/Drive)</label>
                <input type="text" id="inp-url" placeholder="Paste link here...">
            </div>
            
            <!-- CATEGORY DROPDOWN -->
            <div class="inp-group">
                <label>Category (Optional)</label>
                <select id="inp-cat">
                    <!-- Options populated by JS -->
                </select>
            </div>

            <div class="inp-group">
                <label>Duration</label>
                <input type="text" id="inp-dur" placeholder="MM:SS">
            </div>
            <div class="inp-group">
                <label>Description</label>
                <textarea id="inp-desc" rows="3"></textarea>
            </div>
            <button class="btn-primary" onclick="submitVideoForm()" id="modal-btn">Save Video</button>
        </div>
    </div>

    <!-- AUTH MODAL -->
    <div class="modal-wrap" id="auth-modal">
        <div class="modal-box" style="max-width:400px; text-align:center;">
            <span class="material-symbols-rounded" style="font-size:54px; color:var(--primary); margin-bottom:10px;">account_circle</span>
            <h2 id="auth-heading" style="margin:10px 0; color:var(--black);">Sign In</h2>
            <div class="inp-group" style="text-align:left;">
                <label>Email</label>
                <input type="email" id="auth-email">
            </div>
            <div class="inp-group" style="text-align:left;">
                <label>Password</label>
                <input type="password" id="auth-pass">
            </div>
            <button class="btn-primary" onclick="performAuth()" id="auth-submit">Sign In</button>
            
            <p style="margin-top:20px; font-size:14px; cursor:pointer; color:var(--primary); font-weight:500;" onclick="toggleAuthMode()" id="auth-toggle">Create an account</p>
            <button class="icon-btn" onclick="closeModals()" style="position:absolute; top:15px; right:15px;"><span class="material-symbols-rounded">close</span></button>
        </div>
    </div>

    <!-- Link to external JavaScript file -->
    <script type="module" src="script.js"></script>
</body>
</html>
